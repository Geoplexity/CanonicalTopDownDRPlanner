\section{Preliminaries}
\label{sec:prelim}

\subsection{Basics}
%TODO!



In this paper, a {\em geometric constraint system} is a multivariate polynomial 
(usually bilinear or quadratic) system $G(x,\delta)=0$, representing constraints with parameters $\delta$ 
between geometric primitives  in $\mathbb{R}^2$ represented collectively $x\in \mathbb{R}^n$.   
%
When the type of constraint (system) is fixed, the system is simply represented as $(G,\delta)$, where 
$G$ is the underlying constraint (hyper)graph $G = (V,E)$ 
with the vertices $V$ representing the geometric primitives in 
$\mathbb{R}^2$ and (hyper)edges
$E$ representing the constraints, each with an associated 
parameter $\delta$.
%
For example, a {\em bar-joint system or linkage} $(G,\delta)$, is a graph
$G=(V,E)$  
with fixed length bars as edges, i.e. $\delta: E \rightarrow \mathbb{R}$;
this represents the distance constraint system $\| x_u -x_v \|_2 =
\delta_{u,v}$ for  $(u,v) \in E$, where $x_u \in \mathbb{R}^2$ represents the coordinates of
$u\in V$. 

In this paper, we will consider 3 types of constraint systems: bar-joint
as well as {\em pinned line-incidence}, and {\em body-hyperpin}. 
In all of these cases, a cartesian \emph{realization} or 
\emph{solution} $G(p)$ of $(G,\delta)$ is 
an assignment of coordinates or Euclidean transformations (poses), 
$p: V \rightarrow \mathbb{R}^2$ or $\mathbb{R}^3$, to the vertices of $G$ satisfying the 
constraints with parameters $\delta$, 
modulo orientation preserving isometries 
(Euclidean rigid body motions for distance constraint). 

Although the realization space itself depends on the constraint parameters 
$\delta$, many  relevant {\em generic} properties of 
the constraint system $G(x,\delta)$
are properties of the constraint (hyper)graph $G$ 
and do not depend on $\delta$ (or they hold for all but a measure 
zero set of $\delta$
values). Many of these are properties of the jacobian 
$\Delta_x G(x,\delta)$, often called the appropriate {\em rigidity matrix of
$G$} 
(a matrix of indeterminates).
For example, the {\em bar-joint rigidity matrix 
of the graph $G = (V,E)$}
is a matrix of indeterminates representing the 
jacobian of the distance map 
$\| x_u -x_v \|_2$  for $(u,v) \in E$.
The matrix has $2$ columns per vertex in $V$ and one row per edge  in $E$, 
where the row corresponding to edge $(u,v)$ contains the 2 coordinate indeterminates 
for $x_u -x_v$ (resp. $x_v-x_u$) in the 2 columns for $u$ (resp.\ $v$), 
that is 4 non-zero entries per row. 

Some of these generic constraint system or 
(hyper)graph properties are the following ({\bf Note:} we refer to these as
properties of the constraint system or as properties of the underlying
(hyper)graph interchangeably).
%
A constraint (hyper)graph $G$ is {\em independent} if its appropriate rigidity matrix of indeterminates  
has independent rows
(i.e, the determinant of some square submatrix is not
identically zero). 
It is {\em rigid} if the number of independent rows of the rigidity matrix is
at least the number of columns less the number of rigid body motions, 
which is 3 for distance constraint systems. 
It is {\em isostatic (minimally rigid, well-constrained)} 
if it is both rigid and independent. 
%if the number of generically independent rows or the rank of the appropriate rigidity matrix is maximal.
%For example, the maximal rank of a bar-joint rigidity matrix is $2|V| - 3$, 
%where $3$ is the number of rotational and translational degrees-of-freedom of a rigid body in $\mathbb{R}^2$.
%The graph $G$ is {\em rigid} if there exists some spanning subgraph $S\subseteq G$ such that $S$ is well-constrained. 
It is {\em flexible} if it is not rigid, {\em under-constrained} if it is independent and not rigid, or {\em over-constrained} if it is not independent.


In this paper, a {\em qusec} is any {\em independent} geometric 
constraint system of one of the 3
types mentioned above.


The 2-dimensional {\em rigidity matroid} of a constraint (hyper)graph $G = (V,E)$ is a linear matroid  on $E$, 
where a subset of edges $E' \subseteq E$ is {\em independent} in the matroid, 
if the set of corresponding rows in the appropriate rigidity matrix of indeterminates are linearly independent. 

There are various results on combinatorial characterization of independence and rigidity
for different types of  rigidity matroid. 
For bar-joint rigidity matroid, 
the famous Laman's theorem~\cite{???} states that the underlying graph
is minimally rigid if and only if $|E| = 2|V|-3$ and $|E'| \le 2|V'|-3$ for every induced subgraph with at least 2 vertices. 
The result by Lovasz and Yemini~\cite{???} shows that all 6-vertex-connected graphs are rigid in the plane. 
For bar-body rigidity matroid,
Tay~\cite{???} proved that
the underlying multigraph is minimally rigid if and only if it can be decomposed as $3$ edge disjoint spanning trees. 
White and Whiteley~\cite{???} gave the same characterization using a different technique to study the algebraic - geomtric conditions called pure condition.
More generally, 
Lee, Streinu and Theran~\cite{???} defined the {\em $(k,l)$-sparsity matroid}.
A hypergraph $G$ is called {\em $(k,l)$-sparse} if $|E'| \le k|V'| - l$ for any induced subgraph $(V',E')$ with at least 2 vertices, 
and {\em $(k,l)$-tight} if is $(k,l)$-sparse and $|E| = k|V| - l$. 
In general, if you have a $d$-uniform hypergraph, a $(k,l)$-sparsity
condition is matroidal as long as $l \le dk-1$. 

For bar-joint graphs,  
a vector  in the right null space of its rigidity matrix
is called a {\em flex vector}. 
It has 2 entries of indeterminates per vertex and represents the internal motions of the system
(i.e.\ modulo rigid body motions).
For rigid graphs, all flex vectors are  identically zero. 
A vector in the left null space of the rigidity matrix
is called a {\em stress vector}, with one entry of indeterminate per edge.
For independent graphs, all stress vectors are identically zero. 



%--A generalized version of Asimow Roth (implicit fn thm)
%generic rigidity equivalent to infinitesimal rigidity (easy
%when the latter def is based on indeterminates)

% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % %



%XXXXXXXXXXXXXXX BASICS until combinatorial characterization of 
%independence and rigidity XXXXXXXXXXX

NOTE: geometric constraint systems can have inequalities (the parameters
in $\delta$ being inexact, small intervals of values).

XXXXXXXXXsomething has to be said 
along with asimow roth (infinitesimal rigidity 
implies rigidity)
when the rigidity matrix has appropriate rank
the realizations or solutions of the 
of the corresponding constraint system 
are generically isolated and zero-dimensional 
(if the constraint system has equalities and exact 
values for the parameters $\delta$.
If the constraint system has inequalities, i.e, 
if the $\delta$ lie in an interval,
this claim is approximate: 
the solutions are isolated small, full-dimensional  connected components.

%XXXXXXXX Also in the recombination section, it should be noted
%that the HUGE advantage of the convex Cayley method
%is that it is completely unaffected by having the $\delta$ be intervals
%cite my paper with Heping!!!

%XXXXXXXXXX CUrrently there are open problems strewn throughout the paper. 
%Should they be collected to the conclusion?
%Or at least clearly labeled as open problems?
%XXXXXXXXX


\noindent{\bf Note:}
In the remainder of this section and the next two sections 
\ref{sec:DRP} and \ref{sec:recomb} 
we only consider bar-joint qusecs and graphs
Relevant formal analogies  for the other 2 types of qusecs and (hyper)graphs 
are given in the subsequent 2 sections on Applications.

XXXNow comes the definition of stress vector and flex vector. 
NOTE: something has to be said about what flexes and stresses mean

An {\em external stress} $t$ is a $1\times 2|V|$ vector  (of indeterminates)
which specifies a 2D vector acting at each vertex
such that the stress balance equation $sR = t$ holds, where $s$ is a vector
of internal stresses, one for each bar, and $R$ is the rigidity matrix.







\subsection*{Decomposition-Recombination (DR) Plans}

%$G=(V,E,w_V,w_E)$ is a set of vertices, $V$, and a set of edges, $E$, defined as a tuple of vertices from $V$ (undirected). Additionally, there are two weight functions, $w_V: V \to \mathbb{R}^+$ and $w_E: E \to \mathbb{R}^+$. The \textbf{density} of graph $G$ is $d(G) = \sum_{e\in E}{w_E(e)} - \sum_{v\in V}{w_V(v)}$.

%Given a constant $k$, a graph $G$ is:
%\begin{itemize}
%    \item \textbf{independent} (or \textbf{sparse}) if, for all non-trivial subgraphs $S\subseteq G$, $d(S) \leq k$.
%
%    \item \textbf{over-constrained} if it is not independent.
%
%    \item \textbf{well-constrained} (or \textbf{tight}) if $G$ is independent and $d(G)=k$.
%
%    \item \textbf{rigid} if there exists some spanning subgraph $S\subseteq G$ such that $S$ is well-constrained.
%
%    \item \textbf{under-constrained} if $G$ is independent and not rigid.
%
%    % \item \textbf{trivial} if (1) it is over-constrained graph and (2) all of its subgraphs are also trivial. Trivial graphs are input.
%\end{itemize}
%
% \begin{definition}
%     A graph is \textbf{over-constrained} if, given constant $k$, there exists some
%     % induced
%     subgraph $S\subseteq G$ such that $d(S) > k$.
% \end{definition}

% \begin{definition}
%     A graph is \textbf{well-constrained} if, given constant $k$, $d(G) = k$ and for all
%     % induced
%     subgraphs $S\subseteq G$, (1) $d(S)\leq k$, or (2) given a set of trivial graphs $T$, $S$ is isomorphic to one of the graphs in $T$ (i.e.\ $S$ is trivial).
% \end{definition}



% \begin{definition}
%     A \textbf{trivial} graph is ill-defined in the general case. The only strict requirements are: (1) it must be an over-constrained graph and (2) all of its subgraphs are also trivial.
%     \todo{Maybe leave the following out until it's needed later?}
%     In the familiar geometric cases of $d$-dimensional space, all vertex weights are $d$, all edge weights are $1$, and constant $k= -{{d+1}\choose{2}}$. Trivial graphs for 2D would be a single vertex. Trivial graphs in 3D would be a vertex and an edge (2 vertices with an edge between). Etc. These trivial graphs capture the notion of the rotational symmetry that exists in geometric spaces.
% \end{definition}

A \textbf{trivial} graph is   a single vertex.
\begin{definition}\label{def:drp}
    The \textbf{decomposition-recombination \mbox{(DR-)} plan} of graph $G$,
    \cite{XX}
    $DRP(G)$, is defined as a forest that has the following properties:
    \begin{enumerate}
        \item Each  node represents/contains/is  a rigid vertex-induced subgraph of $G$
        %\item For a node, $C$, that is  a non-trivial graph, its $N$
        %    children, $C_1, \ldots, C_N$, are rigid vertex-maximal proper subgraphs of $C$.
        \item The vertex set of $\bigcup_{i=1}^N{C_i}$ is the 
            vertex set of $C$.
        \item A leaf node is a trivial subgraph.
       \item A root node is a maximal rigid subgraph of $G$
    \end{enumerate}

    % It can also be described recursively as: the root is $G$, its children are the trivial subgraphs and the DR-plans of its well-constrained vertex-maximal proper subgraphs whose union is $G$ itself.

    An equivalent DAG can be constructed from the above forest such that all nodes
    containing the same subgraphs are identified into a single node.
    In this manuscript, however, we retain a forest as defined above.
    When a graph is isostatic, its DR plan is a tree.

    %Note that nodes will be referred to interchangeably as ``the node that
    %represents or contains the (sub)graph $C$'' and as simply ``$C$''.

    A DR-plan is \textbf{complete} if it satisfies an additional rule: 
        \item For a node, $C$, that is  a non-trivial graph, its $N$
            children, $C_1, \ldots, C_N$, are all of the 
            rigid vertex-maximal proper subgraphs of $C$.
    This makes Rule 2 implicit, and in fact, $C$ contains all the edges in
    the union of its children as well. The complete DR-plan is unique.

    A DR-plan is \textbf{optimal} if it minimizes the maximum fan-in over all nodes in the tree. It is not necessarily unique.
\end{definition}

% \begin{definition}
%     The \textbf{complete DR-plan} of graph $G$, $CompleteDRP(G)$, is the unique DR-plan but with a modified rule number 2: the children are \emph{all} of the trivial or well-constrained vertex-maximal proper subgraphs of that node $C$. By this, rule 3 is implicit for a complete DR-plan.
% \end{definition}

% \begin{definition}
%     The \textbf{optimal DR-plan} of graph $G$, $OptimalDRP(G)$, is the DR-plan that minimizes the maximum fan-in over all nodes in the tree. It is not necessarily unique.
% \end{definition}




%\emph{well-constrained} bar and joint graph with values $(V,E,w_V,w_E)$.
% \todo{I don't think the following is actually necessary to mention...} To keep problems meaningful we assume that $G$ is connected, as the methods discussed are used to solve systems of equations to establish linkages. It is not useful to solve for two bodies simultaneously if there are no constraints between them.
% THIS MEANS NO EDGES MAY BE LEFT OUT, ALSO.

\noindent{\bf Note:}
In Section \ref{sec:DRP} $G$ is assumed to be isostatic.
$Idc(G,X)$ is the subgraph of $G$ induced by the vertex set $X\subseteq V$. 
For a subgraph $H=(W,F)$ of $G$, $Idc(G,H)=Idc(G,W)$.
In general, $C$ is the graph in an arbitrary node in $CompleteDRP(G)$. $C_i$
is the $i^{\text{th}}$ child of $C$. It is implied that 
$C_i$ is an isostatic vertex-maximal proper subgraph.

\subsection*{Importance of an Optimal DR-plan}
The use of a DR-plan in designing especially self-similar qusecs is
immediately clear, as shown in Figures \ref{XX} and \ref{XX}.
In fact, knowing an optimal DR-plan is crucial for design and analysis of 
even non-self-similar qusecs 
and their realizations with various desirable properties. 

First, note that the basic task of \underbar{{\sl realizing given qusecs}} would require finding real
 solutions 
 a large multivariate polynomial system (of inequalities and equalities
 representing the constraints). Without DR-planning, this requires double
 exponential time in the number of variables
 (even if orientation type is specified).
With DR-planning, the complexity is dominated by the size of the largest 
subsystem that is
solved, or recombined from the solutions of its child subsystems i.e.,the maximum fan-in occuring in a DR-plan.
Thus finding an optimal DR-plan is important for realization.

Next, using the DR-plan we obtain a \underbar{{\sl recursive block
decomposition of the rigidity matrix}}   
with each block being the rigidity matrix of 
an isostatic subgraph.
The blocks intersect on isostatic or trival subgraphs.
This recursive block decomposition of the rigidity matrix $R$ 
correspondingly \underbar{{\sl recursively decomposes the stress vectors}}
$s$ that balance a given
external stress $t$ since $sR = t$, and moreover, the external stress vector
$t$ now \underbar{{\sl recursively "distributes" as external stresses}} 
for each isostatic subgraph of the DR-plan.
When the rigidity matrix and stress vectors are indeterminates, it can be
used to design  qusecs underlying graph and parameters $\delta$ to obtain an  
optimal distribution of stresses on the geometric primitives. 
When the realization of the qusec is given, this can be used to 
analyze the distribution of a  given external load.




%\subsection{DR-plan}
%%\subsection{Definitions}
%%\label{sec:prelim_defs}
%%
%%% TODO
%%
%%% A paragraph of preliminaries such as:
%%%     - rigidity matrix R,
%%%     - stress vectors S one coordinate per edge (w/ SR =E (external stress vector, 2 coordinates  per vertex));
%%%     - flex vectors F (2 coordinates per vertex) (right nullspace/kernel of R)
%%% Should precede the definition of
%%%     + independent,
%%%     + overconstrained (not independent),
%%%     - rigid (contains an independent set with sufficiently many eedges/constraints)
%%%     - isostatic (wellconstrained/minimally rigid), ,
%%%     - flexible (not rigid),
%%%     + underconstrained (independent and not rigid).
%%% After that, define DR plans etc.
%%
%%In Sections \ref{sec:DRP} and \ref{sec:recomb} a \textbf{graph} is a bar and joint system. $G=(V,E,w_V,w_E)$ is a set of vertices, $V$, and a set of edges, $E$, defined as a tuple of vertices from $V$ (undirected). Additionally, there are two weight functions, $w_V: V \to \mathbb{R}^+$ and $w_E: E \to \mathbb{R}^+$. The \textbf{density} of graph $G$ is $d(G) = \sum_{e\in E}{w_E(e)} - \sum_{v\in V}{w_V(v)}$.
%%
%%Given a constant $k$, a graph $G$ is:
%%\begin{itemize}
%%    \item \textbf{independent} (or \textbf{sparse}) if, for all non-trivial subgraphs $S\subseteq G$, $d(S) \leq k$.
%%
%%    \item \textbf{over-constrained} if it is not independent.
%%
%%    \item \textbf{well-constrained} (or \textbf{tight}) if $G$ is independent and $d(G)=k$.
%%
%%    \item \textbf{rigid} if there exists some spanning subgraph $S\subseteq G$ such that $S$ is well-constrained.
%%
%%    \item \textbf{under-constrained} if $G$ is independent and not rigid.
%%
%%    % \item \textbf{trivial} if (1) it is over-constrained graph and (2) all of its subgraphs are also trivial. Trivial graphs are input.
%%\end{itemize}
%%
%\textbf{Trivial} graphs are ill-defined in the general case. The only strict requirements are: (1) it must over-constrained and (2) all of its subgraphs are also trivial.
%
%% \begin{definition}
%%     A graph is \textbf{over-constrained} if, given constant $k$, there exists some
%%     % induced
%%     subgraph $S\subseteq G$ such that $d(S) > k$.
%% \end{definition}
%
%% \begin{definition}
%%     A graph is \textbf{well-constrained} if, given constant $k$, $d(G) = k$ and for all
%%     % induced
%%     subgraphs $S\subseteq G$, (1) $d(S)\leq k$, or (2) given a set of trivial graphs $T$, $S$ is isomorphic to one of the graphs in $T$ (i.e.\ $S$ is trivial).
%% \end{definition}
%
%
%
%% \begin{definition}
%%     A \textbf{trivial} graph is ill-defined in the general case. The only strict requirements are: (1) it must be an over-constrained graph and (2) all of its subgraphs are also trivial.
%%     \todo{Maybe leave the following out until it's needed later?}
%%     In the familiar geometric cases of $d$-dimensional space, all vertex weights are $d$, all edge weights are $1$, and constant $k= -{{d+1}\choose{2}}$. Trivial graphs for 2D would be a single vertex. Trivial graphs in 3D would be a vertex and an edge (2 vertices with an edge between). Etc. These trivial graphs capture the notion of the rotational symmetry that exists in geometric spaces.
%% \end{definition}
%
%
%\begin{definition}\label{def:drp}
%    The \textbf{decomposition-recombination \mbox{(DR-)} plan} of graph $G$, $DRP(G)$, is defined as a tree that has the following properties:
%    \begin{enumerate}
%        \item The root of the tree `contains' $G$.
%        \item For all nodes, $C$, that `contain' non-trivial graphs, its $N$ children, $C_1, \ldots, C_N$, are trivial or well-constrained vertex-maximal proper subgraphs of that node $C$.
%        \item The vertex set of $\bigcup_{i=1}^N{C_i}$ is the vertex set of $C$.
%        \item A node with a trivial subgraph is a leaf.
%    \end{enumerate}
%
%    % It can also be described recursively as: the root is $G$, its children are the trivial subgraphs and the DR-plans of its well-constrained vertex-maximal proper subgraphs whose union is $G$ itself.
%
%    An equivalent DAG can be constructed from this tree such that all nodes containing the same subgraphs are combined into one, with all edges preserved.
%
%    Note that nodes will be referred to interchangeably as ``the node that contains the (sub)graph $C$'' and as simply ``$C$''.
%
%    A DR-plan is \textbf{complete} if it satisfies the modified rule number 2: the children are \emph{all} of the trivial or well-constrained vertex-maximal proper subgraphs of that node $C$. This makes rule 3 implicit. The complete DR-plan is unique.
%
%    A DR-plan is \textbf{optimal} if it minimizes the maximum fan-in over all nodes in the tree. It is not necessarily unique.
%\end{definition}
%
%% \begin{definition}
%%     The \textbf{complete DR-plan} of graph $G$, $CompleteDRP(G)$, is the unique DR-plan but with a modified rule number 2: the children are \emph{all} of the trivial or well-constrained vertex-maximal proper subgraphs of that node $C$. By this, rule 3 is implicit for a complete DR-plan.
%% \end{definition}
%
%% \begin{definition}
%%     The \textbf{optimal DR-plan} of graph $G$, $OptimalDRP(G)$, is the DR-plan that minimizes the maximum fan-in over all nodes in the tree. It is not necessarily unique.
%% \end{definition}
%
%
%\subsection{Notation}
%
%In Sections \ref{sec:DRP} and \ref{sec:recomb}, $G$ is taken to be a \emph{well-constrained} bar and joint graph with values $(V,E,w_V,w_E)$.
%% \todo{I don't think the following is actually necessary to mention...} To keep problems meaningful we assume that $G$ is connected, as the methods discussed are used to solve systems of equations to establish linkages. It is not useful to solve for two bodies simultaneously if there are no constraints between them.
%% THIS MEANS NO EDGES MAY BE LEFT OUT, ALSO.
%
%$Idc(G,X)$ is the graph induced on $G$ with the vertex set $X\subseteq V$. This can also be overloaded such that, using graph $H=(W,F)$, $Idc(G,H)=Idc(G,W)$.
%
%$C$ is the graph in an arbitrary node in $CompleteDRP(G)$. $C_i$ is the $i^{\text{th}}$ child of $C$. By definition of a DR-plan, it is implied that $C_i$ is a well-constrained vertex-maximal proper subgraph.

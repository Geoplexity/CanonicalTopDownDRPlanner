\section{Appendix A}
\label{sec:appendix:a}

\subsection{Proofs from Section \ref{sec:DRP}}

\newcommand{\usestwod}{\todo{Uses 2D requirement:}}
\renewcommand{\usestwod}{}


\subsubsection{Proof of Theorem \ref{theorem:main}}






\begin{proof}
We show the existence of a canonical DR-plan by constructing it as follows:

Begin with $\comdrp{G}$ of a rigid 2D bar-joint graph $G$, for all nodes $C$
with children $C_1,\ldots,C_N$ keep children nodes according to the following rules:
\begin{enumerate}
   \item If $C_i \cap C_j$ is trivial then keep all $C_1,\ldots,C_N$ as children.
   \item If $C_i \cap C_j$ is rigid then select any two out of $C_1,\ldots,C_N$ as children.
\end{enumerate}

This directly satisfies properties 2 and 3 of a canonical DR-plan (see definition \ref{def:canonical_drplan}), because all the nodes in $\comdrp{G}$ are rigid vertex-maximal proper subgraphs. However, we still have to show property 1 (that this makes a DR-plan).
For rule (1), because we are beginning with a complete DR-plan, if we keep all the children it is still a DR-plan. For rule (2), we know that the union must be rigid as well and it cannot be anything other than $C$, otherwise we have found a larger rigid vertex-maximal proper subgraph.

If we begin with an isostatic graph, rigid can be replaced with isostatic throughout the construction and remain valid. The rigid proper subgraphs of an isostatic graph must be isostatic themselves.

Now we must show that a canonical DR-plan is optimal. The proof is by induction on the level of the plan; we show that following these rules always guarantees minimum fan-in at this level and does not increase fan-in on following levels.

 % We do this inductively on the l, beginning with the root node, showing that the rules are always the optimal choice.
% by discussing each rule and proving inductively that this is the optimal choice at each level of the DR-plan tree, starting with the root node.


% Now we show that this plan is optimal by considering the two cases. Observation \ref{lemma:union_intersection} shows that we do not have to consider anything other than the two cases stated in the construction.
 % the intersection of any two isostatic subgraphs can only result in trivial or isostatic subgraphs. Therefore, given $C$ and its isostatic vertex-maximal subgraphs $C_1,\ldots,C_N$, the are only two possibilities to consider. Either (1) subgraphs $C_i$ and $C_j$ have a trivial intersection, or (2) they have an isostatic intersection.





\medskip\noindent
\vemph{Rule 1:}
% If some pair is intersecting trivially, then in fact all pairs intersect trivially, thus all must be children by defn of canonical drplan
%
First, we claim that if the intersection is trivial all $C_1,\ldots,C_N$ must be children of $C$ in an optimal DR-plan. We do this by showing that no subset of the children can union to form $C$, thereby requiring all of them be included; because this is the only choice, it is the minimum fan-in any DR-plan could have for this node.
% must be optimal for this node.

Take the strict subset $S\subsetneq \{1,\ldots,N\}$ such that $U=\bigcup_{i\in S}{C_i}$ which we \vemph{assume} is isostatic. If $U\neq C$, then we just found a larger proper subgraph and the children were not vertex-maximal to begin with. So, it must be that $U=C$.
\usestwod
However, since $C_i \cap C_j$ is trivial then for $k\notin S$ we know, by Lemma \ref{lemma:combined_lemma}, point \ref{lemma:uc_intersection_makes_all_uc}, $U\cap C_k$ must be one or more trivial subgraphs. By definition of a DR-plan $C_k=C\cap C_k$ and we know that $U=C$ so $C_k=U\cap C_k$. Thus, $C_k$ is both one or more trivial subgraphs and a isostatic subgraph of $C$. Thus, the assumption is wrong and $U$ cannot be isostatic. As $C$ is isostatic, this means no proper subset of $C_1,\ldots,C_N$ can union to form $C$.

Furthermore, since a canonical DR-plan uses proper rigid \vemph{vertex-maximal} subgraphs as children, and because their pairwise intersection is trivial, it follows that any such node has at most as many children as a DR-plan without this restriction, because the union of the children have to contain all edges of the parent. Therefore, this is the optimal choice in this case.

\medskip\noindent
\vemph{Rule 2:} Second, we claim that if the intersection is isostatic, the choice of any two children will result in an optimal DR-plan.

If $C_i \cap C_j$ is isostatic, then, by Observation \ref{lemma:union_intersection}, $C_i \cup C_j$ is also isostatic. This means that, by Lemma \ref{lemma:combined_lemma}, point \ref{lemma:wc_intersection_makes_all_wc}, any two children of $C$ will union to $C$ itself. Thus, any two children can be chosen to make a canonical DR-plan.
% are potential choices for the optimal DR-plan as they all create equal fan-in (exactly two) at this level.

\newcommand{\induceonc}[1]{Idc\left(C,#1\right)}
\renewcommand{\induceonc}[1]{#1}
\newcommand{\iunion}[1]{\induceonc{I\cup\bigcup_{k\in S_N\setminus\{#1\}}{R_k}}}

However, to guarantee that any two are the \vemph{optimal} choice, it must ensure minimum fan-in over all descendants. Take the set $S_N=\{1,\dots,N\}$, then we call $I=\bigcap_{k\in S_N}{C_k}$ and $R_k=C\setminus C_k$. Suppose we select $i$ and $j$, where $i\neq j$, as the children. For convenience, we will assume all subgraphs are induced subgraphs on $C$. We know that $C=\induceonc{I\cup\bigcup_{k\in S_N}{R_k}}$ and $C_i=\iunion{i}$. The isostatic vertex-maximal subgraphs of $C_i$ are $(\iunion{i,1}),\ldots,(\iunion{i,i-1}),(\iunion{i,i+1}),\ldots,(\iunion{i,N})$ all of which intersect on isostatic subgraphs. So any two of these are viable children for $C_i$.
% Since
% \[C_i=Idc\left(C,I\cup\bigcup_{k\in S_N\setminus\{i\}}{R_k}\right)\]
% the children of $C_i$ will be
% \[Idc\left(C,I\cup\bigcup_{k\in S_N\setminus\{i,m\}}{R_k}\right)\]
% and
% \[Idc\left(C,I\cup\bigcup_{k\in S_N\setminus\{i,n\}}{R_k}\right)\]
% % $C_i=Idc\left(C,I\cup\bigcup_{k\in S_N\setminus\{i\}}{R_k}\right)$
% % the children of this node will be
% % $Idc\left(C,I\cup\bigcup_{k\in S_N\setminus\{i,m\}}{R_k}\right)$
% % and
% % $Idc\left(C,I\cup\bigcup_{k\in S_N\setminus\{i,n\}}{R_k}\right)$
% for arbitrary $m$ and $n$, where $i,j,m,n$ do not equal each other. \todo{Prove these are valid children? Or is this obvious?}
This continues for $N-1$ levels total, always with fan-in of two (the minimum possible), at which point every descendant of $C$ is some $\induceonc{I\cup R_k}$ for $k\in S_N$, with every $k$ appearing at least once. Thus, regardless of the choice of $C_i,C_j$, then their children, etc., the DR-plan has fan-in of two for every node for the next $N$ levels, at which point the nodes contain the same subgraphs. Therefore, the choice is optimal.
%
% \medskip\noindent
% This proof then applies to itself recursively to show that the fan-in of the children will also be minimum.
%
% -- say this at top `proof is by induction on the level of the dr=plan'
\end{proof}


\subsubsection{Proof of Observation \ref{lemma:union_intersection}}

\begin{proof}
For (1), simply note that if $F_i\cup F_j$ were trivial, then, by definition, $F_i$ and $F_j$ must be trivial.

For (2), observe that underconstrained subgraphs of isostatic graphs must have density less than $k$. For (3), observe that, given a isostatic graph, a subgraph with density $k$ must also be isostatic. Then, use the fact that, by definition, $d(F_i)=k$ and $d(F_j)=k$. Then it is straightforward application of the equation $d(F_i\cap F_j)=d(F_i)+d(F_j)-d(F_i\cup F_j)$.

For (4), because subgraphs of a isostatic graph can only be trivial, under-, or isostatic, all cases have already been exhausted.
\end{proof}


% \begin{proof}
% Use the fact that, by definition, $d(F_i)=k$ and $d(F_j)=k$. Also, the equation $d(F_i\cap F_j)=d(F_i)+d(F_j)-d(F_i\cup F_j)$.
% \begin{enumerate}
%     \item If $F_i\cup F_j$ were trivial, then, by definition, $F_i$ and $F_j$ must be trivial.

%     \item Observe that  Then it is straightforward application of the equation above.

%     % \item Observe that, given a isostatic graph, an underconstrained subgraph must have density less than $k$. Then it is straightforward application of the equation above.

%     \item Observe that, given a isostatic graph, a subgraph with density $k$ must also be isostatic. Then it is straightforward application of the equation above.

%     % \item \textit{Forward direction:} Since $F_i\cup F_j$ is underconstrained and a subgraph of isostatic $F$, it must be that $d(F_i\cup F_j)=l<k$. Therefore $d(F_i\cap F_j)=2k-l>k$. This means $F_i\cap F_j$ is trivial. \textit{Reverse direction:} We know that $d(F_i\cap F_j)>k$ because it is trivial. By the same math, we find that $d(F_i\cup F_j)<k$, showing it is underconstrained.

%     % \item \textit{Forward direction:} We have that $d(F_i\cup F_j)=k$, therefore $d(F_i\cap F_j)=k$. Being a subgraph of isostatic $F$, $F_i\cap F_j$ is also isostatic. \textit{Reverse direction:} By the same math, we find that $d(F_i\cup F_j)=k$ and, since it is also a subgraph of $F$, it is isostatic.

%     \item Subgraphs of a isostatic graph can only be trivial, under-, or isostatic. All cases are already exhausted.
% \end{enumerate}
% \end{proof}




\subsubsection{Proof of Lemma \ref{lemma:combined_lemma}, Point \ref{lemma:wc_intersection_is_C}}

\begin{proof}
Assume $C_i\cup C_j \neq C$, then we just found a larger proper subgraph and $C_i,C_j$ were not vertex-maximal to begin with.
%
In the reverse direction, we know $C$ is either some non-leaf node (isostatic by definition of a DR-plan) or $G$ itself (isostatic by definition of the problem). Thus, $C_i\cup C_j=C$ is isostatic.
\end{proof}


\subsubsection{Proof of Lemma \ref{lemma:combined_lemma}, Point \ref{lemma:wc_intersection_makes_all_wc}}

\begin{observation}\label{observation:no_edges_between_diff}
Let us say $R_i=C\setminus C_i$ and $R_j=C\setminus C_j$. If $C_i\cup C_j$ is isostatic, then there can be no edges in $C$ between the vertices of $R_i$ and $R_j$.
\end{observation}

\begin{proof}
Lemma \ref{lemma:combined_lemma}, point \ref{lemma:wc_intersection_is_C}, shows that $C_i\cup C_j$ must equal the entire parent $C$.
\end{proof}


\begin{proof} (Of Lemma \ref{lemma:combined_lemma}, Point \ref{lemma:wc_intersection_makes_all_wc})

The alternative phrasing is due to Lemma \ref{lemma:combined_lemma}, point \ref{lemma:wc_intersection_is_C}.

Let us say $R_i=C\setminus C_i$, $R_j=C\setminus C_j$, and $D_{i,j}=C_i\cap C_j=(C\setminus R_i)\setminus R_j$ (note that $R_j\subset C_i$, $R_i\subset C_j$ and $D_{i,j}\subset C_i,C_j$). Furthermore, we have the proper subgraphs $R'_i\subset R_i$, $R'_j\subset R_j$, and $D'_{i,j}\subset D_{i,j}$ which are not empty sets.

Then we assume that there is some third isostatic vertex-maximal proper subgraph $C_k$ (with $C'_k=C\setminus C_k$). There are $3\times 3\times 3 = 27$ possible cases for what this subgraph could be.

For convenience, it is implied that all graphs are the induced graph on $C$.
\newcommand{\inducedOnC}[1]{#1}

% \newcommand{\inducedOnC}[1]{Idc\left(C,#1\right)}

\begin{itemize}
    \item 3 cases: $C_k$ cannot be $C=\inducedOnC{R_i\cup R_j\cup D_{i,j}}$, $C_i=\inducedOnC{R_j\cup D_{i,j}}$, or $C_j=\inducedOnC{R_i\cup D_{i,j}}$. This is by definition.

    \item 13 cases: $C_k$ cannot be a proper subgraph of $C_i$ and $C_j$ or else $C_k$ would not be vertex-maximal. These are the graphs $\inducedOnC{R'_i\cup D_{i,j}}$, $\inducedOnC{R'_j\cup D_{i,j}}$, $\inducedOnC{ D_{i,j}}$, $\inducedOnC{R_i\cup D'_{i,j}}$, $\inducedOnC{R_j\cup D'_{i,j}}$, $\inducedOnC{R'_i\cup D'_{i,j}}$, $\inducedOnC{R'_j\cup D'_{i,j}}$, $\inducedOnC{ D'_{i,j}}$, $\inducedOnC{R_i}$, $\inducedOnC{R_j}$, $\inducedOnC{R'_i}$, $\inducedOnC{R'_j}$, and $\inducedOnC{\emptyset}$.

    \item 2 cases: $C_k$ cannot contain $C_i$ or $C_j$ as proper subgraphs, or else they were not vertex-maximal. These are the graphs $\inducedOnC{R'_i\cup R_j\cup D_{i,j}}$ and $\inducedOnC{R_i\cup R'_j\cup D_{i,j}}$ respectively.

    \item 4 cases: \usestwod $C_k$ cannot be $\inducedOnC{R_i\cup R_j}$, $\inducedOnC{R'_i\cup R_j}$, $\inducedOnC{R_i\cup R'_j}$, or $\inducedOnC{R'_i\cup R'_j}$ because these are all disconnected (Observation \ref{observation:no_edges_between_diff}) and cannot be isostatic.

    \item 1 case: $C_k=\inducedOnC{R'_i\cup R'_j\cup D_{i,j}}$ is not possible. Since $C_i\cup C_k = \inducedOnC{R'_i\cup R_j\cup D_{i,j}}\neq C$ we have from Lemma \ref{lemma:combined_lemma}, point \ref{lemma:wc_intersection_is_C}, that $C_i\cup C_k$ cannot be isostatic. We also know it cannot be trivial because it contains isostatic subgraphs. This means it must be underconstrained. From Observation \ref{lemma:union_intersection}, we know that $C_i\cap C_k=\inducedOnC{R'_j\cup D_{i,j}}$ must then be trivial. This is impossible because $D_{i,j}$ is isostatic, thereby contradicting the assumption that $C_k$ is isostatic.

    \item 1 case: \usestwod $C_k=\inducedOnC{R'_i\cup R'_j\cup D'_{i,j}}$ is not possible. Since $C_i\cup C_k\neq C$ (and $C_j\cup C_k\neq C$), we know by the same logic as the previous case that the $C_i\cap C_k$ must be trivial (a single node). However, $C_i\cap C_k=\inducedOnC{R'_j\cup D'_{i,j}}$. This causes a contradiction, the intersection cannot be trivial because $R'_j$ and $D'_{i,j}$ are not empty sets and are disjoint.

    \item 2 cases: \usestwod $C_k=\inducedOnC{R'_i\cup R_j\cup D'_{i,j}}$ and $C_k=\inducedOnC{R_i\cup R'_j\cup D'_{i,j}}$ are not possible. The proof mirrors the previous case, except here you must choose $C_i$ and $C_j$ respectively.

    \item 1 case: $C_k=\inducedOnC{R_i\cup R_j\cup D'_{i,j}}$ is all that remains.
\end{itemize}

Since $D_{i,j}\subset C_i, C_j$ it means that $C_k\cup C_i = C_k \cup C_j = C$, thus proving the Lemma.
%
% \todo{Need a figure?}
\end{proof}

\subsubsection{Proof of Lemma \ref{lemma:combined_lemma}, Point \ref{lemma:uc_intersection_makes_all_uc}}

\begin{proof}
Assume there is some $k$ such that $C_i\cap C_k$ is not trivial. By Observation \ref{lemma:union_intersection}, $C_i\cap C_k$ must be isostatic. Then, by Lemma \ref{lemma:combined_lemma}, point \ref{lemma:wc_intersection_makes_all_wc}, the intersection between any two children must be isostatic. This means that $C_i\cap C_j$ is isostatic. Therefore, such a $k$ cannot exist and all intersections are trivial.
\end{proof}


\subsubsection{Proof of Theorem \ref{theorem:algo_complexity}}

\begin{proof}
The first step of the algorithm is finding the isostatic vertex-maximal proper subgraphs of the input isostatic graph $G$. Do this by first dropping arbitrary edge $e$ from the edge set and running the pebble game algorithm \cite{Jacobs:1997:PG} on this subgraph, which is $O(|V|^2)$. The output of this will be a list of component-candidates. Then run the Frontier algorithm \cite{hoffman2001decompositionII} \cite{lomonosov2004graph} ($O(|V|)$) on each candidate along with edge $e$, which will find the minimal subgraph $D$ that contains the candidate and $e$. If $D=G$, move the candidate (before adding $e$) to the true-component list and remove it from the candidate-component list. If $D\subsetneq G$, remove all candidates that are subgraphs of $D$ from the candidate-component list and add $D$ back to the list. Continue with the next candidate. When you exhaust the candidates, move to the next step.

Test the intersection of any two of the true-components. If the intersection is trivial, the entire list becomes the children. Recursively apply the algorithm to each child.

If the intersection is non-trivial (necessarily isostatic), immediately compute the sequential decomposition down to $I=\bigcap_{k\in S_N}{C_k}$. The root of this idea is discussed in detail in the proof of Theorem \ref{theorem:main}, and we use the notation here. We construct a DR-plan whose node set is the same as that of a canonical/optimal DR-plan. Begin with the parent $C$. Its children will be $C\setminus R_1$ and $R_1$ plus the nodes and edges adjacent to $R_1$ that lie in $I$. Recursively apply the algorithm to the child containing $R_1$. The children of $C\setminus R_1$ will be $C\setminus (R_1\cup R_2)$ and $R_2$ plus the nodes and edges adjacent to $R_2$ that lie in $I$. And so on. At $N$ levels down, the 2 children will be $I$ and $R_N$ plus the nodes and edges adjacent to $R_N$ that lie in $I$. Apply the algorithm recursively to both children.
% Although the nodes containing $R_1,\ldots,R_N$ are underconstrained, simply take the children to be the roots of the forest

The reason for this construction is that the result is a tree with no duplicate nodes. The leaves of this tree will exactly be the edges of this graph. Therefore, the number of nodes in the tree is $O(|E|)$ which, for isostatic input graphs, is $O(|V|)$.

Therefore, the complexity of the algorithm as a whole is $O(|V|^3)$.
%
% \note In the best case, this can be $O(V^2)$ if the graph is a 2-tree
\end{proof}


% \begin{proof}
% The first step of the algorithm is finding the isostatic vertex-maximal proper subgraphs of the input isostatic graph $G$. Do this by first dropping arbitrary edge $e$ from the edge set and running the pebble game algorithm \cite{Jacobs:1997:PG} on this subgraph, which is $O(|V|^2)$. The output of this will be a list of component-candidates. Then run the Frontier algorithm \cite{hoffman2001decompositionII} \cite{lomonosov2004graph} ($O(|V|)$) on each candidate along with edge $e$, which will find the minimal subgraph $D$ that contains the candidate and $e$. If $D=G$, move $D$ to the true-component list and remove the candidate from the candidate-component list. If $D\subsetneq G$, check the union of $D$ with the all items in the true-component list; if the union is isostatic, halt and output just these two components as children. Otherwise, remove all candidates that are subgraphs of $D$ from the candidate-component list and add $D$. Continue with the next candidate. If you exhaust the candidates, output the entire true-component list.

% %on the children
% This is run recursively on each node. If you use dynamic programming to store the decompositions of each component, it prevents repetition of work (done by using the DAG representation of the DR-plan). In this case you will have to do work on no more than $O(|V|)$ nodes that get smaller at each level.

% Thus, the running time is at most $O(|V|^3)$. \todo{does this amortize correctly?}

% It's a tree in only trivial case -> O(V), always order of leaves
% If its isostatic intersection, we do the sequential extension,intersections only done once.

% inductively. The number of nodes at this level will e more than the total. Number of leaves (terminals for dag) is at most the number of edges

% \end{proof}

% \begin{proof}
% The first step of the algorithm to find an optimal DR-plan is the most difficult --- to find the wellconstrained vertex-maximal proper subgraphs of the input wellconstrained graph. There are two approaches: (1) the bottom-up approach, using the Frontier algorithm \cite{Oung:2001:FFE:376957.376995} to grow these components from single vertices; and (2) the top-down approach, using the pebble game algorithm \cite{Jacobs:1997:PG} on each node and taking the largest components that are not subgraphs of any larger ones. After the subgraphs have been found, it is a straightforward application of the theory. If the intersection of any two of the subgraphs is wellconstrained, then take those two to be children of the graph. Otherwise, all the subgraphs are the children. Apply recursively to the children. This naturally terminates when you reach trivial subgraphs. The complexity of this depends on the algorithm for finding children (both are polynomial) and the depth of the plan (the deeper the plan, i.e.\ the smaller the max fan-in, the longer the running time). \todo{Think more about complexity.}
% \end{proof}


\subsection{Proofs from Section \ref{sec:recomb}}

\subsubsection{Proof of Theorem \ref{theorem:omdk}}
\begin{proof}
The proof follows from the fact that 2-trees are well decomposable and
have simple DR-plans of size 2. We know that $G$ can be reduced by
removing $k$ edges to create a partial-2-tree $G'$ which can then be
completed to an (isostatic) 2-tree by adding some set of non-edges
$F$. Thus the modified graph $H = G'\cup F$ has  a DR-plan of size 2,
proving the theorem.
\end{proof}

\subsubsection{Proof of Theorem \ref{theorem:criterionc}}
\begin{proof}
    The Cartesian realization space of $(H,\left<\delta_{E'},
    \lambda_F\right>)$ is computed easily with a DR-plan of size 2,
    and is the union of $2^t$ solutions (modulo orientation preserving
    isometries) each with a distinct orientation type, where $t$ is
    the number of triangles in the 2-tree $H$; here $\delta_{S}$ is
    the restriction of the length vector $\delta$ to the edges in $S$.
    A desired solution $p$ (or connected component of a solution
    space) of $(G,\delta)$ of an orientation type $\sigma_p$ can be
    found by a subdivided binary search   of the cartesian realization
    space of $(H, \left<\delta_{E'}, \lambda_F\right>)$ of orientation
    type $\sigma_p$ - as $\lambda_F$ ranges over the discretized
    convex polytope $\Phi_F(G',\delta_E')$ with bounding hyperplanes
    described in Theorem \ref{theorem:convexcayley}. A solution $p$
    is found  when the lengths for nonedges in $D$ match $\delta_D$.
\end{proof}


\subsection{Proofs from Section \ref{sec:bodypin}}

\subsubsection{Proof of Remark \ref{rem:bodypin_is_barjoint}}
\begin{proof}
    We can replace each body that has only one pin by a single vertex. A body with 2 pins can be replaced by an edge. In general, a body with $n$ pins can be replaced by a 2-tree on $n$ vertices. When finding a DR-plan, we treat each body as trivial, so they become the leaves of our plan. The optimal recombination problem and approach of Section \ref{sec:recomb} are unchanged. The optimal completion via the optimal modification problem in Section \ref{sec:recomb} now has an additional constraint that all edges in the 2-tree representation of the bodies must be removed together, not individually.
\end{proof}

\subsubsection{Proof of Observation \ref{obs:bodypin_drp}}
\begin{proof}
    The existence of this canonical DR-plan follows from the same arguments as in the proof of Theorem \ref{theorem:main}. The only difference is the definition of a trivial intersection. In this case, when two subgraphs share more than 1 body, they become rigid (in fact over constrained). Sharing a pin is not considered an intersection. Such a structure is viewed as two subgraphs each sharing 1 body with a 3rd 1-dof subgraph which essentially just consists of those two bodies pinned together.
\end{proof}

\subsubsection{Proof of Remark \ref{thm:1dofcase}}
\begin{proof}
    Suppose we are given a body-pin graph and its corresponding body-bar graph $G$ and have obtained the 1-dof DR-plan $T$. Each node of $T$ will then be a vertex maximal proper 1-dof sub-graph of $G$.

    To make the graph isostatic, we need only add one body and pin it to 2 other bodies. Doing so will cause $G$ to become $(3,3)$-tight. We choose the 2 bodies to pin to by choosing a node $b$ in $T$ and looking at its children. From Observation \ref{rem:1dofcanon}, we know that the children can only be joined by a single pin or a sub-graph. We pin the new body to bodies in two separate children. Doing so will ensure that all children of $b$ will have 1-dof and all ancestors of $b$ (including $b$) will now be isostatic.

    % Then, we can form a valid isostatic DR-plan $T_b$ from $T$. In $T_b$, $fanin(b)$is the number of leaves in the subtree rooted at $b$ because no child of $b$ in $T$ is isostatic. Similarly, for any other node $w$ that is an ancestor of $b$, $fanin(w)$ is the the number leaf nodes in the tree rooted at $w$, excluding the subtree constaining $b$, plus 1 (for the node leading to $b$).  Then, for any node $b$ that we choose, $T_b$ is a valid DR-plan. The size of $T_b$ will just be the maximum fanin of all nodes in $T_b$. Thus, if we want to minimize the size of our DR-plan, we simply need to take the $b$ that has the $T_b$ of smallest size.

    Such a pinning covers all possible ways of adding a new body. Assume we add a new body $b$ to our graph and pin it to $b_i$ and $b_j$ to make it isostatic. Then, there will be some lowest 1-dof node $v$ in $T$ such that $b_i$ and $b_j$ appear in $v$. Thus, pinning $v$ in the manner described yields an equivalent isostatic DR-plan to pinning $b$ to $b_i$ and $b_j$.

    For each node $b$, we assign a size of the $T_b$ denoted $|T_b|$. $|T_b| = \displaystyle\max_{v \in T_b} fanin(v)$. We are looking for $b$ that minimizes $|T_b|$. Denote the sub-tree of $T$ rooted at $v$ by $T^v$ and the number of leaves in a tree $T$ by $nl(T)$. Note that $fanin(b)= nl(T^b)$ because no descendant of $b$ is isostatic. Similarly, for any ancestor $w$ of $b$, $fanin(w) = nl(T^w)-nl(T^{b'})+1$, where $b'$ is the child leading to $b$. All other nodes are not isostatic and so have no fanin.

    % Then, we can form a valid isostatic DR-plan $T_b$ from $T$. In $T_b$, $b$'s children are now all of the leaf nodes of the subtree rooted at $b$ because no child of $b$ in $T$ is isostatic. Similarly, for any other node $w$ that is an ancestor of $b$, $w$'s children will be the node that leads to $b$, denoted $b'$, along with all of the other leaf nodes in the tree rooted at $w$, excluding $b'$. Then, for any node $b$ that we choose, $T_b$ is a valid DR-plan. The size of $T_b$ will just be the maximum fanin of all nodes in $T_b$. Thus, if we want to minimize the size of our DR-plan, we simply need to take the $b$ that has the $T_b$ of smallest size.

    The node we need to pin will always be the deepest nontrivial node of some path in $T$. Suppose we chose to pin a node $b$ that has a nontrivial child $v$. Then, $fanin_b(b) = nl(T^b) = nl(T^v) + n$, where $n$ is essentially the number of leaves between $b$ and $v$. If we had instead chosen to pin $v$, then $fanin_v(b) = nl(T^b) - nl(T^{b'}) + 1 \leq fanin_b(v)$. And for each ancestor $w$ of $b$, $fanin(w)$ is unchanged, meaning $|T_v| \leq |T_b|$. Thus we only have to check the deepest non-trivial nodes.

    Running this algorithm in a brute force fashion is quadratic in the number of bodies of our given body-pin system.

    For the multi-triangle pin graphs, we can do the same thing except we need to add a single triangle to one of the nodes to cause it to become isostatic.
    % Don't leave a blank line between last paragraph and end!
    % For the 2-dof case, we can do something very similar, except instead of pinning a single body 2 times to a node, we can pin another body 2 times to a node. These can be the same node, and if it is the same node, we can find a wellconstrained DR-plan in quadratic time, we would just be doing the same thing as the 1-dof case.
\end{proof}

\subsubsection{Proof of Observation \ref{obs:2dof_case}}
\begin{proof}
    The only difference from the 1-dof case is that now we need to remove 2-dof from our graph. We build a 2-dof DR-plan $T$. Like above, we need to add a body and 2 pins to 2 nodes now to get to isostatic.

    Suppose we pin 2 distinct nodes $v_i$ and $v_j$. Then, there will be some common ancestor $a$ of $v_i$ and $v_j$. Then, in $T_{v_i,v_j}$, $fanin_{v_i,v_j}(a) = nl(T^a)$. However, if we chose to pin one of $v_i$ and $v_j$ twice, then $fanin_v(a) = nl(T^a) - nl(T^{a'}) +1$ . Thus $fanin_v(a)' \leq fanin_{v_i,v_j}(a)$. All ancestors of $a$ are unchanged. So $|T_v| \leq |T_{v_i,v_j}|$.

    So, we will always end up pinning a single node twice. Hence, we can run the same algorithm as the 1-dof case and just pin twice instead of once.
\end{proof}

\subsubsection{Proof of Observation \ref{obs:algebraic_completion}}
\begin{proof}
    An isostatic graph has 3 parameters that define it (in terms of coming up with a realizaiton). These are the Euclidean motions. A 1-dof graph can be seen as essentially having 4 parameters: the 3 Euclidean motions and whatever degree of freedom it has. A 2-dof has 5 parameters, and so on. These paramters denote the algebraic complexity of giving a realization for the graphs.

    Thus, say we have a $T$ as described in the proof for Remark \ref{thm:1dofcase}. When we pin a node $b$, we will have the same structure as before. Suppose we are looking at an isostatic node $v$ after pinning $b$. Then, the children of $v$ (except one if $v \neq b$) will be 1-dof. The complexity for that node is then just that of solving each of its children. In general then, the number of parameters for that node will be $np(v) = 4nc_1(v)+3$, if $v \neq b$ and $np(b) = 4nc_1(b)$, where $nc_k(v)$ is the number of $k$-dof children of $v$.

    Now if we want to minimize the algebraic complexity, we need to minimize the maximum $np(v)$ for any node $v$. In this case, we cannot always just choose the node furthest down the tree to pin because it could have many children. So we will have to try pinning all nodes to see which gives the lowest algebraic complexity. This is still quadratic for the 1-dof case.

    For the 2-dof case, there are more cases to consider. If we pin the same node twice as above, we have $np(v) = 5nc_2(v)+3$ for any ancestor $v \neq b$ and $np(b) = 5nc_2(b)$. If we pin a node $v$ and one of its ancestors $v'$, then any nodes between $v'$ and $v$ will be 1-dof, any nodes above $v'$ will be isostatic, and nodes below $v$ will be 2-dof. Note that solving $v'$ will result in solving $v$. Then, we need to consider nodes above and includiing $v'$ in our complexity. $np(v') = 5nc_2(v') + 4$ and $np(a) = 3 + 5nc_2(a)$ for $a$ an ancestor of $v'$. The only remaining case will be if we pin two nodes that are not descendent/ancestor. the only change from the previous case will be that for the lowest common ancestor of the nodes $v'$, $np(v') = 2*4+5nc_2(v')$. For any ancestor $a$ of $v'$, we still have $np(a) = 3 + 5nc_2(a)$.

    Like the 1-dof case, we again cannot just choose the nodes deepest in the tree to pin. However, we cannot also assume pinning one node twice will give us the best algebraic complexity. Hence, we will need to check each pair of node to pin. This makes our brute-force algorithm $O(b^3)$, where $b$ is the number of bodies.
\end{proof}




\subsection{Proofs from Section \ref{sec:pinnedline}}
\subsubsection{Proof of Lemma \ref{lemma:combined_lemma}, Point \ref{lemma:wc_intersection_makes_all_wc} --- For 2-dimensional pinned line incidence graphs}
\label{sec:appendix_pinned}

\begin{proof} %[Proof of Lemma~\ref{lemma:wc_intersection_makes_all_wc} for 2D pinned line incidence graphs]
We use the same notations as in the original proof of Lemma \ref{lemma:combined_lemma}, Point \ref{lemma:wc_intersection_makes_all_wc}, in the last section.

First notice that since $C_i \cup C_j$ is isostatic, by Observation~\ref{lem:pinned_union_intersection},
both $C_i$ and $C_j$ are connected isostatic vertex-maximal proper subgraphs of  $C$.
Since $C_j \cup C_j = C$, there are no edges in $C$ that is not contained in a isostatic subgraph, so $C$ does not have any single-edge child node, and $C_k$ is a connected isostatic vertex-maximal proper subgraph of  $C$.

Then we analyze all the possible cases for $C_k$.
\begin{itemize}
    \item 1 case: $C_k=Idc(C,R'_i\cup R'_j\cup D_{i,j})$ is not possible. Since $C_k\cup C_i = Idc(C,R'_i\cup R_j\cup D_{i,j})\neq C$ we have from Lemma \ref{lemma:combined_lemma}, Point \ref{lemma:wc_intersection_is_C}, that $C_k\cup C_i$ cannot be isostatic.
    By Lemma~\ref{lem:pinned_union_intersection}, it must be underconstrained,
    so one of $C_i$ and $C_k$ must be an edge, contradicting the assumption that both $C_i$ and $C_k$ are isostatic.

    \item 1 case: $C_k=Idc(C,R'_i\cup R'_j\cup D'_{i,j})$ is not possible. The proof is similar to the previous case.

    \item 2 cases: $C_k=Idc(C,R'_i\cup R_j\cup D'_{i,j})$ and $C_k=Idc(C,R_i\cup R'_j\cup D'_{i,j})$ are not possible.
    The proof is similar to the previous case.
\end{itemize}

All remaining cases are similar to the original proof.
\end{proof}


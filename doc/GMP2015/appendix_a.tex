\section{Appendix}
\label{sec:appendix}

\subsection{Section \ref{sec:DRP} -- {\sffamily \textbf{Lemma \ref{lemma:wc_intersection_makes_all_wc}}}}

% \textbf{Section \ref{sec:DRP}}

% {\sffamily \textbf{Lemma \ref{lemma:main_trivial}}
\begin{corollary}\label{corollary:no_edges_between_diff}
Let us say $R_i=C\setminus C_i$ and $R_j=C\setminus C_j$. If $C_i\cup C_j$ is well-constrained, then there can be no edges in $C$ between the vertices of $R_i$ and $R_j$.
\end{corollary}

\begin{proof}
Lemma \ref{lemma:wc_intersection_is_C} shows that $C_i\cup C_j$ must equal the entire parent $C$.
\end{proof}


\begin{proof} (Of Lemma \ref{lemma:wc_intersection_makes_all_wc})

The alternative phrasing is due to Lemma \ref{lemma:wc_intersection_is_C}.

Let us say $R_i=C\setminus C_i$, $R_j=C\setminus C_j$, and $D_{i,j}=C_i\cap C_j=(C\setminus R_i)\setminus R_j$ (note that $R_j\subset C_i$, $R_i\subset C_j$ and $D_{i,j}\subset C_i,C_j$). Furthermore, we have the proper subgraphs $R'_i\subset R_i$, $R'_j\subset R_j$, and $D'_{i,j}\subset D_{i,j}$ which are not empty sets.

Then we assume that there is some third well-constrained vertex-maximal proper subgraph $C_k$ (with $C'_k=C\setminus C_k$). There are $3\times 3\times 3 = 27$ possible cases for what this subgraph could be.

For convenience, it is implied that all graphs are the induced graph on $C$.
\newcommand{\inducedOnC}[1]{#1}

% \newcommand{\inducedOnC}[1]{Idc\left(C,#1\right)}

\begin{itemize}
    \item 3 cases: $C_k$ cannot be $C=\inducedOnC{R_i\cup R_j\cup D_{i,j}}$, $C_i=\inducedOnC{R_j\cup D_{i,j}}$, or $C_j=\inducedOnC{R_i\cup D_{i,j}}$. This is by definition.

    \item 13 cases: $C_k$ cannot be a proper subgraph of $C_i$ and $C_j$ or else $C_k$ would not be vertex-maximal. These are the graphs $\inducedOnC{R'_i\cup D_{i,j}}$, $\inducedOnC{R'_j\cup D_{i,j}}$, $\inducedOnC{ D_{i,j}}$, $\inducedOnC{R_i\cup D'_{i,j}}$, $\inducedOnC{R_j\cup D'_{i,j}}$, $\inducedOnC{R'_i\cup D'_{i,j}}$, $\inducedOnC{R'_j\cup D'_{i,j}}$, $\inducedOnC{ D'_{i,j}}$, $\inducedOnC{R_i}$, $\inducedOnC{R_j}$, $\inducedOnC{R'_i}$, $\inducedOnC{R'_j}$, and $\inducedOnC{\emptyset}$.

    \item 2 cases: $C_k$ cannot contain $C_i$ or $C_j$ as proper subgraphs, or else they were not vertex-maximal. These are the graphs $\inducedOnC{R'_i\cup R_j\cup D_{i,j}}$ and $\inducedOnC{R_i\cup R'_j\cup D_{i,j}}$ respectively.

    \item 4 cases: \todo{Uses 2D requirement:} $C_k$ cannot be $\inducedOnC{R_i\cup R_j}$, $\inducedOnC{R'_i\cup R_j}$, $\inducedOnC{R_i\cup R'_j}$, or $\inducedOnC{R'_i\cup R'_j}$ because these are all disconnected (Corollary \ref{corollary:no_edges_between_diff}) and cannot be well-constrained.

    \item 1 case: $C_k=\inducedOnC{R'_i\cup R'_j\cup D_{i,j}}$ is not possible. Since $C_i\cup C_k = \inducedOnC{R'_i\cup R_j\cup D_{i,j}}\neq C$ we have from Lemma \ref{lemma:wc_intersection_is_C} that $C_i\cup C_k$ cannot be well-constrained. We also know it cannot be trivial because it contains well-constrained subgraphs. This means it must be under-constrained. From Lemma \ref{lemma:union_intersection}, we know that $C_i\cap C_k=\inducedOnC{R'_j\cup D_{i,j}}$ must then be trivial. This is impossible because $D_{i,j}$ is well-constrained, thereby contradicting the assumption that $C_k$ is well-constrained.

    \item 1 case: \todo{Uses 2D requirement:} $C_k=\inducedOnC{R'_i\cup R'_j\cup D'_{i,j}}$ is not possible. Since $C_i\cup C_k\neq C$ (and $C_j\cup C_k\neq C$), we know by the same logic as the previous case that the $C_i\cap C_k$ must be trivial (a single node). However, $C_i\cap C_k=\inducedOnC{R'_j\cup D'_{i,j}}$. This causes a contradiction, the intersection cannot be trivial because $R'_j$ and $D'_{i,j}$ are not empty sets and are disjoint.

    \item 2 cases: \todo{Uses 2D requirement:} $C_k=\inducedOnC{R'_i\cup R_j\cup D'_{i,j}}$ and $C_k=\inducedOnC{R_i\cup R'_j\cup D'_{i,j}}$ are not possible. The proof mirrors the previous case, except here you must choose $C_i$ and $C_j$ respectively.

    \item 1 case: $C_k=\inducedOnC{R_i\cup R_j\cup D'_{i,j}}$ is all that remains.
\end{itemize}

Since $D_{i,j}\subset C_i, C_j$ it means that $C_k\cup C_i = C_k \cup C_j = C$, thus proving the Lemma.

\todo{Need a figure?}
\end{proof}

\subsection{Section \ref{sec:pinnedline} -- proof of {\sffamily \textbf{Lemma \ref{lemma:wc_intersection_makes_all_wc}}} for  2-dimensional pinned line incidence graphs }
\label{sec:appendix_pinned}

\begin{proof} %[Proof of Lemma~\ref{lemma:wc_intersection_makes_all_wc} for 2D pinned line incidence graphs]
We use the same notations as in the original proof of Lemma~\ref{lemma:wc_intersection_makes_all_wc} in the last section.

First notice that since $C_i \cup C_j$ is well-constrained, by Lemma~\ref{lem:pinned_union_intersection},
both $C_i$ and $C_j$ are connected well-constrained vertex-maximal proper subgraphs of  $C$.
Since $C_j \cup C_j = C$, there are no edges in $C$ that is not contained in a well-constrained subgraph, so $C$ does not have any single-edge child node, and $C_k$ is a connected well-constrained vertex-maximal proper subgraph of  $C$.

Then we analyze all the possible cases for $C_k$.
\begin{itemize}
    \item 1 case: $C_k=Idc(C,R'_i\cup R'_j\cup D_{i,j})$ is not possible. Since $C_k\cup C_i = Idc(C,R'_i\cup R_j\cup D_{i,j})\neq C$ we have from Lemma \ref{lemma:wc_intersection_is_C} that $C_k\cup C_i$ cannot be well-constrained.
    By Lemma~\ref{lem:pinned_union_intersection}, it must be under-constrained,
    so one of $C_i$ and $C_k$ must be an edge, contradicting the assumption that both $C_i$ and $C_k$ are well-constrained.

    \item 1 case: $C_k=Idc(C,R'_i\cup R'_j\cup D'_{i,j})$ is not possible. The proof is similar to the previous case.

    \item 2 cases: $C_k=Idc(C,R'_i\cup R_j\cup D'_{i,j})$ and $C_k=Idc(C,R_i\cup R'_j\cup D'_{i,j})$ are not possible.
    The proof is similar to the previous case.
\end{itemize}

All remaining cases are similar to the original proof.
\end{proof}


\subsection{Proofs from Section \ref{sec:recomb}}

\subsubsection{Proof of Theorem \ref{theorem:omdk}}
\begin{proof}
The proof follows from the fact that 2-trees are well decomposable and
have simple DR-plans of size 2. We know that $G$ can be reduced by
removing $k$ edges to create a partial-2-tree $G'$ which can then be
completed to an (isostatic) 2-tree by adding some set of non-edges
$F$. Thus the modified graph $H = G'\cup F$ has  a DR-plan of size 2,
proving the theorem.
\end{proof}

\subsubsection{Proof of Theorem \ref{theorem:criterionc}}
\begin{proof}
    The Cartesian realization space of $(H,\left<\delta_{E'},
    \lambda_F\right>)$ is computed easily with a DR-plan of size 2,
    and is the union of $2^t$ solutions (modulo orientation preserving
    isometries) each with a distinct orientation type, where $t$ is
    the number of triangles in the 2-tree $H$; here $\delta_{S}$ is
    the restriction of the length vector $\delta$ to the edges in $S$.
    A desired solution $p$ (or connected component of a solution
    space) of $(G,\delta)$ of an orientation type $\sigma_p$ can be
    found by a subdivided binary search   of the cartesian realization
    space of $(H, \left<\delta_{E'}, \lambda_F\right>)$ of orientation
    type $\sigma_p$ - as $\lambda_F$ ranges over the discretized
    convex polytope $\Phi_F(G',\delta_E')$ with bounding hyperplanes
    described in Theorem \ref{theorem:convexcayley}. A solution $p$
    is found  when the lengths for nonedges in $D$ match $\delta_D$.
\end{proof}


\subsection{Proofs from Section \ref{sec:bodypin}}

\subsubsection{Proof of Remark \ref{rem:bodypin_is_barjoint}}
\begin{proof}
    We can replace each body that has only one pin by a single vertex. A body with 2 pins can be replaced by an edge. In general, a body with $n$ pins can be replaced by a 2-tree on $n$ vertices. When looking for a DR-plan, we treat each body as trivial, so they become the leaves of our plan. The optimal completion problem and approach of Section \ref{sec:DRP} are unchanged. The optimal parameterization problem in Section \ref{sec:DRP} now has an additional constraint that all edges in the 2-tree representation of the bodies must be removed together, not individually.
\end{proof}

\subsubsection{Proof of Observation \ref{obs:bodypin_drp}}
\begin{proof}
    \todo{Item 1 Follows from paper?}

    For item 2, consider the case where we have more than 2 proper vertex maximal 1-dof sub-graphs $s_1, ..., s_k, k > 2$. Then, if $k_i$ and $k_j$ are joined by $2$ pins, $k_i \cup k_j$ would be $(3,4)$-tight and hence $k_i$ and $k_j$ are not vertex maximal.
\end{proof}

\subsubsection{Proof of Observation \ref{thm:1dofcase}}
\begin{proof}
    Suppose we are given a body-pin graph and its corresponding body-bar graph $G$ and have obtained the 1-dof DR-plan $T$. Each node of $T$ will then be a vertex maximal proper 1-dof sub-graph of $G$.

    To make the graph isostatic, we need only add one body and pin it to 2 other bodies. Doing so will cause $G$ to become $(3,3)$-tight. We choose the 2 bodies to pin to by choosing a node $b$ in $T$ and looking at its children. From Observation \ref{rem:1dofcanon}, we know that the children can only be joined by a single pin or a sub-graph. We pin the new body to bodies in two separate children. Doing so will ensure that all children of $b$ will have 1-dof and all ancestors of $b$ (including $b$) will now be isostatic.

    % Then, we can form a valid isostatic DR-plan $T_b$ from $T$. In $T_b$, $fanin(b)$is the number of leaves in the subtree rooted at $b$ because no child of $b$ in $T$ is isostatic. Similarly, for any other node $w$ that is an ancestor of $b$, $fanin(w)$ is the the number leaf nodes in the tree rooted at $w$, excluding the subtree constaining $b$, plus 1 (for the node leading to $b$).  Then, for any node $b$ that we choose, $T_b$ is a valid DR-plan. The size of $T_b$ will just be the maximum fanin of all nodes in $T_b$. Thus, if we want to minimize the size of our DR-plan, we simply need to take the $b$ that has the $T_b$ of smallest size.

    Such a pinning covers all possible ways of adding a new body. Assume we add a new body $b$ to our graph and pin it to $b_i$ and $b_j$ to make it isostatic. Then, there will be some lowest 1-dof node $v$ in $T$ such that $b_i$ and $b_j$ appear in $v$. Thus, pinning $v$ in the manner described yields an equivalent isostatic DR-plan to pinning $b$ to $b_i$ and $b_j$.

    For each node $b$, we assign a size of the $T_b$ denoted $|T_b|$. $|T_b| = \displaystyle\max_{v \in T_b} fanin(v)$. We are looking for $b$ that minimizes $|T_b|$. Denote the sub-tree of $T$ rooted at $v$ by $T^v$ and the number of leaves in a tree $T$ by $nl(T)$. Note that $fanin(b)= nl(T^b)$ because no descendant of $b$ is isostatic. Similarly, for any ancestor $w$ of $b$, $fanin(w) = nl(T^w)-nl(T^{b'})+1$, where $b'$ is the child leading to $b$. All other nodes are not isostatic and so have no fanin.

    % Then, we can form a valid isostatic DR-plan $T_b$ from $T$. In $T_b$, $b$'s children are now all of the leaf nodes of the subtree rooted at $b$ because no child of $b$ in $T$ is isostatic. Similarly, for any other node $w$ that is an ancestor of $b$, $w$'s children will be the node that leads to $b$, denoted $b'$, along with all of the other leaf nodes in the tree rooted at $w$, excluding $b'$. Then, for any node $b$ that we choose, $T_b$ is a valid DR-plan. The size of $T_b$ will just be the maximum fanin of all nodes in $T_b$. Thus, if we want to minimize the size of our DR-plan, we simply need to take the $b$ that has the $T_b$ of smallest size.

    The node we need to pin will always be the deepest nontrivial node of some path in $T$. Suppose we chose to pin a node $b$ that has a nontrivial child $v$. Then, $fanin_b(b) = nl(T^b) = nl(T^v) + n$, where $n$ is essentially the number of leaves between $b$ and $v$. If we had instead chosen to pin $v$, then $fanin_v(b) = nl(T^b) - nl(T^{b'}) + 1 \leq fanin_b(v)$. And for each ancestor $w$ of $b$, $fanin(w)$ is unchanged, meaning $|T_v| \leq |T_b|$. Thus we only have to check the deepest non-trivial nodes.

    Running this algorithm in a brute force fashion is quadratic in the number of bodies of our given body-pin system.

    For the multi-triangle pin graphs, we can do the same thing except we need to add a single triangle to one of the nodes to cause it to become isostatic.
    % Don't leave a blank line between last paragraph and end!
    % For the 2-dof case, we can do something very similar, except instead of pinning a single body 2 times to a node, we can pin another body 2 times to a node. These can be the same node, and if it is the same node, we can find a wellconstrained DR-plan in quadratic time, we would just be doing the same thing as the 1-dof case.
\end{proof}

\subsubsection{Proof of Observation \ref{obs:2dof_case}}
\begin{proof}
    The only difference from the 1-dof case is that now we need to remove 2-dof from our graph. We build a 2-dof DR-plan $T$. Like above, we need to add a body and 2 pins to 2 nodes now to get to isostatic.

    Suppose we pin 2 distinct nodes $v_i$ and $v_j$. Then, there will be some common ancestor $a$ of $v_i$ and $v_j$. Then, in $T_{v_i,v_j}$, $fanin_{v_i,v_j}(a) = nl(T^a)$. However, if we chose to pin one of $v_i$ and $v_j$ twice, then $fanin_v(a) = nl(T^a) - nl(T^{a'}) +1$ . Thus $fanin_v(a)' \leq fanin_{v_i,v_j}(a)$. All ancestors of $a$ are unchanged. So $|T_v| \leq |T_{v_i,v_j}|$.

    So, we will always end up pinning a single node twice. Hence, we can run the same algorithm as the 1-dof case and just pin twice instead of once.
\end{proof}

\subsubsection{Proof of Observation \ref{obs:algebraic_completion}}
\begin{proof}
    An isostatic graph has 3 parameters that define it (in terms of coming up with a realizaiton). These are the Euclidean motions. A 1-dof graph can be seen as essentially having 4 parameters: the 3 Euclidean motions and whatever degree of freedom it has. A 2-dof has 5 parameters, and so on. These paramters denote the algebraic complexity of giving a realization for the graphs.

    Thus, say we have a $T$ as described in the proof for Theorem \ref{thm:1dofcase}. When we pin a node $b$, we will have the same structure as before. Suppose we are looking at an isostatic node $v$ after pinning $b$. Then, the children of $v$ (except one if $v \neq b$) will be 1-dof. The complexity for that node is then just that of solving each of its children. In general then, the number of parameters for that node will be $np(v) = 4nc_1(v)+3$, if $v \neq b$ and $np(b) = 4nc_1(b)$, where $nc_k(v)$ is the number of $k$-dof children of $v$.

    Now if we want to minimize the algebraic complexity, we need to minimize the maximum $np(v)$ for any node $v$. In this case, we cannot always just choose the node furthest down the tree to pin because it could have many children. So we will have to try pinning all nodes to see which gives the lowest algebraic complexity. This is still quadratic for the 1-dof case.

    For the 2-dof case, there are more cases to consider. If we pin the same node twice as above, we have $np(v) = 5nc_2(v)+3$ for any ancestor $v \neq b$ and $np(b) = 5nc_2(b)$. If we pin a node $v$ and one of its ancestors $v'$, then any nodes between $v'$ and $v$ will be 1-dof, any nodes above $v'$ will be isostatic, and nodes below $v$ will be 2-dof. Note that solving $v'$ will result in solving $v$. Then, we need to consider nodes above and includiing $v'$ in our complexity. $np(v') = 5nc_2(v') + 4$ and $np(a) = 3 + 5nc_2(a)$ for $a$ an ancestor of $v'$. The only remaining case will be if we pin two nodes that are not descendent/ancestor. the only change from the previous case will be that for the lowest common ancestor of the nodes $v'$, $np(v') = 2*4+5nc_2(v')$. For any ancestor $a$ of $v'$, we still have $np(a) = 3 + 5nc_2(a)$.

    Like the 1-dof case, we again cannot just choose the nodes deepest in the tree to pin. However, we cannot also assume pinning one node twice will give us the best algebraic complexity. Hence, we will need to check each pair of node to pin. This makes our brute-force algorithm $O(b^3)$, where $b$ is the number of bodies.
\end{proof}

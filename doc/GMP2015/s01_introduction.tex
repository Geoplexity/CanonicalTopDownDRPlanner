\section{Introduction}
\label{sec:intro}

% \newcommand{\meeraheader}[2]{\medskip\noindent\underbar{{\sl (#1) #2}}}

Some properties of natural and engineered materials can be analyzed by
treating them as stacked two dimensional (2D) layers. The structure
within each layer could be self-similar \cite{Intro1} spanning
multiple scales, generally aperiodic and quasi-uniform within any one
scale, and consisting of a few repeated motifs appearing in disordered
arrangements. Each layer is not necessarily planar, i.e., it consists
of multiple, inter-constraining planar (genus 0) monolayers.
Furthermore, a layer is often  either \vemph{isostatic or
under-constrained, not self-stressed} (See Section \ref{sec:prelim} for
definitions). These properties are consistent with a self-assembled 2D
structure that minimizes mass, optimally distributes external stresses
and itself participates in the assembly of diverse and
multifunctional, larger 2D structures.

\begin{figure*}\centering
% \begin{subfigure}{.31\linewidth}\centering
%   \includegraphics[width=\linewidth]{img/Axopodium_Mikrotubuli}
%   \caption{Cross section of a Heliozoa's psuedopod, formed by a spiral structure of microtubules.}
%   % https://de.wikipedia.org/wiki/Mikrotubulus#mediaviewer/File:Axopodium_Mikrotubuli.jpg
%   \label{fig:material_examples:microtubule}
% \end{subfigure}\hfill
% \begin{subfigure}{.31\linewidth}\centering
%   \includegraphics[width=\linewidth]{img/Transverse_Section_Of_Bone}
%   \caption{Cross section of an osteon (the fundamental unit of compact bone) exhibiting its hierarchical structure.}
%   % https://en.wikipedia.org/wiki/Osteon#mediaviewer/File:Transverse_Section_Of_Bone.png
%   \label{fig:material_examples:osteon}
% \end{subfigure}\hfill
\begin{subfigure}{.28\linewidth}\centering
  \includegraphics[width=\linewidth]{img/Chlamydomonas_TEM_17}
  \caption{Cross section of the Chlamydomonas algae axoneme, a cilia composed of microtubules.}
  % https://en.wikipedia.org/wiki/Axoneme#mediaviewer/File:Chlamydomonas_TEM_17.jpg
  \label{fig:material_examples:microtubule}
\end{subfigure}\hfill
\begin{subfigure}{.40\linewidth}\centering
  \includegraphics[width=\linewidth]{img/ligten2}
  \caption{Cross section of a tendon displaying the hierarchical structure.}
  % http://www.umich.edu/~bme332/ch10ligten/ligten2.jpg
  \label{fig:material_examples:tendon}
\end{subfigure}\hfill
\begin{subfigure}{.30\linewidth}\centering
  \includegraphics[width=\linewidth]{img/Rothemund-DNA-SierpinskiGasket}
  \caption{A DNA array exhibiting the Sierpinski triangle.}
  % https://en.wikipedia.org/wiki/DNA_nanotechnology#mediaviewer/File:Rothemund-DNA-SierpinskiGasket.jpg
  \label{fig:material_examples:sierpinski}
\end{subfigure}
\caption{}\label{fig:material_examples}
\end{figure*}


Examples of such materials (See Figure \ref{fig:material_examples})
include:

\begin{enumerate}
    \item Cross-sections of microtubule structures (Figure \ref{fig:material_examples:microtubule}) \cite{Necklace1} e.g., in ciliary membranes and transitions \cite{Necklace2}

    \item Cross-sections of organic tissue with hierarchical structure, e.g. compact bone and tendon (Figure \ref{fig:material_examples:tendon}) \uncited

    \item Crosslinked cellulose or collagen microfibril monolayers e.g., in cell-walls \cite{CellWalls1} \cite{CellWalls1}, as well as crosslinked actin filaments in the cytoskeleton matrix.

    \item More recent, engineered examples, including disordered graphene layers \cite{Graphene1} \cite{Graphene2} sometimes reinforced by  microfibrils; and DNA assemblies \cite{Microfibrils1} including a recent Sierpinski carpet, bringing other self-similar structures \cite{Microfibrils2} within reach.

    \item Silica bi-layers, glass \cite{SilicaGlass1} \cite{SilicaGlass2}, and materials that behave like assemblies of 2D particles under non-overlap constraints, e.g, jammed disks on the plane \cite{JammedDisk1}
\end{enumerate}
%
In order to study structural and mechanical properties such as
rigidity, flexes and distribution of external stresses within the
material layer, it is natural to model a material layer as a solution
of a geometric constraint system of appropriate types of geometric
primitives, under metric or algebraic constraints. Such 2D
\dfn{qusecs} (quasi-uniform or self-similar constraint systems) can be
used to understand or design material layers (their solutions) with
desired properties.

\subsection{Previous Work on Relevant 2D Geometric Constraint Systems}
We now briefly survey existing techniques for studying 2D
\dfn{qusecs},  many of which are \dfn{bar-joint} systems
(Examples 1, 2 above, see Sections \ref{sec:DRP}, \ref{sec:recomb}),
\dfn{body-hyperpin} systems (Example 4,5, see Section
\ref{sec:bodypin}) or \dfn{pinned-line incidence} systems (Example
3, see Section \ref{sec:pinnedline}). The limitations of these
techniques directly motivate the contributions of this paper.

\medskip\noindent
\header{(i) Finding (vertex)-maximal generically rigid subsystems}
Fast, graph-based algorithms exist (pebble-game \cite{Jacobs:1997:PG}), for
locating all maximal, generically rigid subsystems \uncited. When the
input is rigid, these algorithms compute the identity and output the
input.

However, both for self-similar or just aperiodic 2D qusecs, it is
imperative to recursively decompose rigid systems into their rigid
subsystems, down to the level of geometric primitives, in order to
understand or design properties at all scales, such as: rigidity,
flexes, distribution of external stresses, boundary conditions for
isostaticity, as well as behavior under constraint variations.

\medskip\noindent
\header{(ii) Optimal Recursive Decomposition (DR-planning)}
Recursive decomposition of geometric constraint systems has been
formalized \uncited and well-studied \uncited as the \dfn
{Decomposition-Recombination (DR)-planning} problem. For the above-
mentioned classes of 2D qusecs, generic rigidity is a combinatorial
property and hence each level of the decomposition should, in
principle, be achievable by a graph-based algorithm as in (1), without
involving geometric information in the constraint system. Since many
such decompositions can exist for a given constraint system, criteria
defining desirable or optimal DR-plans and DR-planning algorithms were
given in \uncited. An \dfn{optimal DR-plan} is one that minimizes
the maximum number of child subsystems of any parent system, a
property that is crucial for obtaining a solution to the parent
constraint system from the solutions of the child systems.

However, for general 2D qusecs, even when restricted to bar-joint
systems, the optimal DR-planning problem was shown to be NP-hard
\uncited.

\medskip\noindent
\header{(iii) DR-plans for special classes and with other
criteria}
For a special class of 2D qusecs, namely \dfn{tree-decomposable}
systems \uncited common in computer aided mechanical design, (which
includes ruler-and-compass and Henneberg-I constructible systems), all
DR-plans turn out to be optimal. This satisfies the so-called \dfn
{Church-Rosser} criterion, leading to highly efficient DR-planning
algorithms. For general 2D qusecs, alternate criteria were suggested
such as \dfn{cluster minimality} requiring parent systems to be
composed of a minimal set of at least 2 rigid proper subsystems (i.e.,
no proper subset forms a rigid system); and \dfn{proper maximality},
requiring child subsystems to be maximal rigid proper subsystems of
the parent system.

While polynomial time algorithms were given \uncited to generate DR-
plans meeting the cluster minimality criterion, no such algorithm is
known for the latter criterion.


\medskip\noindent
\header{(iv) Optimal Recombination and Solution Space Navigation}
For the entire DR-plan, finding all desired solutions is barely
tractable even if recombination of solved subsystems is easy for each
indecomposable parent system in the DR-plan. This is because even for
the simplest, highly decomposable systems with small DR-plans, the
problem of finding even a single solution to the input system at the
root of the DR-plan is NP-hard \uncited and there is a combinatorial
explosion of solutions \uncited. Typically, however, the desired
solution has a given orientation type, in which case, the crux of the
difficulty is concentrated in the algebraic complexity of
(re)combining child system solutions, to give a solution to the parent
system at any given level of the DR-plan. For fairly general 3D
constraint systems, there are algorithms with formal guarantees that
uncover underlying matroids to combinatorially obtain an optimal
parameterization to minimize the algebraic complexity of the
indecomposable parent (sub)systems that occur in the DR-plan \uncited\uncited\uncited, provided the DR-plan meets some of the abovementioned
criteria.

However, the generality of these algorithms trades-off against
efficiency, and despite the optimization, the best algorithms can
still take exponential time in the number of child subsystems (which
can be arbitrarily large even for optimal DR-plans) in order to
guarantee all solutions of a given orientation type, even for a single
(sub)system in a DR-plan. They are prohibitively slow in practice. We
note that, utilizing the DR-plan and optimal recombination as a
principled basis, high performance heuristics and software exists
\uncited\uncited to tame combinatorial explosion via user intervention.


\medskip\noindent
\header{(v) Configuration Spaces of Under-constrained Systems}
For under-constrained 2D bar-joint and body-hyperpin qusecs obtained
from various subclasses of tree-decomposable systems, algorithms have
been developed \uncited\uncited to complete them into isostatic systems
\uncited\uncited and to find paths within the connected components
\uncited\uncited of standard Cartesian configuration spaces. Most of the
algorithms with formal guarantees leverage Cayley configuration space
theory \uncited\uncited to characterize subclasses of graphs and
additional constraints that control combinatorial explosion, and
provide faithful bijective representation of connected components and
paths. These algorithms have decreasing efficiency as the subclass of
systems gets bigger, with highest efficiency for underlying partial
2-tree graphs (alternately, tree-width 2, series- parallel, $K_4$
minor avoiding), moderate efficiency for 1 degree- of-freedom (dof)
graphs with low Cayley complexity (which include common linkages such
as the Strandbeest, Limacon and Cardioid), and decreased efficiency
for general 1-dof tree-decomposable graphs. While software suites
exist \uncited\uncited, no such formal algorithms and guarantees are known
for non-tree-decomposable systems.

\subsection{Contributions and Organization}
\label{sec:cont}

The contributions of this paper are the following.
\begin{itemize}
  \item We navigate the NP-hardness barrier mentioned in (2) above,
  for finding optimal DR-plans by defining a so-called \dfn{canonical}
  DR-plan and showing a strong Church-Rosser property: \vemph{all
  canonical DR-plans for isostatic or under-constrained 2D qusecs are
  optimal} (Section \ref{sec:DRP}).

  \item We give an efficient ($O(n^2)$) algorithm to find a canonical
  (and hence optimal) DR-plan for all 3 types of 2D qusecs mentioned
  above (Sections \ref{sec:DRP}, \ref{sec:bodypin}, and
  \ref{sec:pinnedline}). The canonical DR-plan illuminates the essence
  of the NP-hardness of finding optimal DR-plans for over-constrained
  systems.

  \item We give a method to deal with the algebraic complexity of
  recombining the realizations or solutions of child subsystems into a
  solution of the parent system. Specifically, we define the problem
  of minimally modifying the indecomposable recombination system so
  that it becomes decomposable via a small DR-plan and yet preserves
  the original solutions in an efficiently searchable manner. We show
  formal connection to well known problems such as optimal completion
  of under-constrained systems \uncited. When the required
  modifications are bounded, we obtain new, efficient algorithms for
  realizing both isostatic and under-constrained qusecs by leveraging
  recent results about Cayley parameters in \uncited\uncited (Section
  \ref{sec:recomb}).

  \item We briefly describe applications of the above techniques to
  modeling, analyzing, and designing specific properties in 2D material
  layers. For Examples 1,2 (achieving isostaticity, distribution of
  stresses in self-similar, bar-joint systems); Example 3 (canonical
  and optimal DR-plans for pinned line incidence systems \uncited)
  and Examples 4,5 (boundary-conditions for achieving various desired
  properties of body-hyperpin systems).

  \item Software implementation and videos can be found at:
  \todo{Provide Link}.
\end{itemize}
